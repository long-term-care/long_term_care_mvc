@model IEnumerable<long_term_care.Models.CaseInfor>

<link href="~/css/Reg.css" rel="stylesheet" />
<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css" />
<body>
    @*
    <div id="fullscreen-image">
        <button  class="btn btn-primary" onclick="location.href='@Url.Action("Login", "Main")'">返回</button>
        <h2 id="register">註冊</h2>
        <h4 id="identity">請選擇身分</h4>
        <div class="section">
            <button id="volunteer">志工</button>
            <button id="elder">長者</button>
        </div>
    </div>*@
    <div id="volunteerMsgBox">
        <div class="container">
            <div class="title">
                <h3>註冊</h3>
                <div class="knownAs">
                    <p>照護人員</p>
                </div>
                <div style="color:red; display:flex; align-items:center;">
                    <h4>*為必填欄位</h4>
                </div>
            </div>
            <hr>
            <form class="volunteer">
                <div class="row">
                    <div class="col-4">
                         <label for="memunitname">單位名稱<span class="required">*</span></label>
                          <input type="text" placeholder="&nbsp;&nbsp;" required id="memunitname">                      
                    </div>
                    <div class="col-4">
                        <label for="memunitid">單位編號<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;" required id="memunitid">
                    </div>
                    <div class="col-4">
                        <label for="memid">員工證號碼<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;" required id="memid" value="@ViewBag.MemNo" readonly>
                    </div>
                </div>
                <div class="row">
                    <div class="col-3">
                        <label for="memlastname">姓氏<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;" required id="memlastname">
                    </div>
                    <div class="col-3">
                        <label for="memfirstname">名字<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;" required id="memfirstname">
                    </div>
                    <div class="col-3">
                        <label for="memgender">性別<span class="required">*</span></label>
                        <select id="memgender" required>
                            <option value=""></option>
                            <option value="男">男</option>
                            <option value="女">女</option>
                        </select>
                    </div>
                    <div class="col-3">
                        <label for="memidcard">身分證<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;" required id="memidcard">
                    </div>
                </div>
                <div class="row">
                    <div class="col-3">
                        <label for="CaseBD">出生日期<span class="required">*</span></label>
                        <input type="date" placeholder="&nbsp;&nbsp;" required id="CaseBD">
                    </div>
                    <div class="col-3">
                        <label for="memlistidentity">身分別<span class="required">*</span></label>
                        <select id="memlistidentity" required>
                            <option value=""></option>
                            <option value="Low-income">低收入戶</option>
                            <option value="near-poor">中低收入戶</option>
                            <option value="normal">一般戶老人</option>
                            <option value="solitary">獨居老人</option>
                            <option value="handicapped">身心障礙者</option>
                            <option value="others">其他</option>
                        </select>
                    </div>
                   <div class="col-3">
                        <label for="serviceaddress">服務據點<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;服務據點" id="serviceaddress" required>
                    </div>
                    <div class="col-3">
                        <label for="IC">IC<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;健保卡號碼" id="IC" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col-4">
                        <label for="memtel">電話<span class="required">*</span></label>
                        <input type="tel" placeholder="&nbsp;&nbsp;" id="memtel" required>
                    </div>
                    <div class="col-3">
                        <label for="memphone">手機<span class="required">*</span></label>
                        <input type="tel" placeholder="&nbsp;&nbsp;" id="memphone" required>
                    </div>
                    <div class="col-4">
                        <label for="memaddress">地址<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;地址" id="memaddress" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col-4">
                        <label for="mempassword">密碼<span class="required">*</span></label>
                        <input type="password" placeholder="&nbsp;&nbsp;" required id="mempassword">
                    </div>
                    <div class="col-4">
                        <label for="mempasswordcheck">密碼確認<span class="required">*</span></label>
                        <input type="password" placeholder="&nbsp;&nbsp;" required id="mempasswordcheck">
                    </div>
                    @*4*@
                </div>
                <div class="row">
                    <div class="col-4">
                        <label for="memeducationLevel">教育程度</label>
                        <select id="memeducationLevel">
                            <option value=""></option>
                            <option value="不識字">不識字</option>
                            <option value="自修">自修</option>
                            <option value="國小">國小</option>
                            <option value="國中">國中</option>
                            <option value="高中職">高中職</option>
                            <option value="專科">專科</option>
                            <option value="大學">大學</option>
                            <option value="研究所以上">研究所以上</option>
                        </select>
                    </div>
                    <div class="col-4">
                        <label for="expertise">專長</label>
                        <input type="text" placeholder="&nbsp;&nbsp;" id="expertise">
                    </div>
                    <div class="col-4">
                        <label for="transportation">交通工具</label>
                        <input type="text" placeholder="&nbsp;&nbsp;交通工具"  id="transportation">
                    </div>
                </div>
                <div class="box">
                    <div class="boxL">
                        <div class="grid-container">
                            <div class="grid-item">
                                <label for="license">證照</label>
                                <input type="text" class="boxes"  id="license">
                            </div>
                            <div class="grid-item">
                                <label for="service">提供服務</label>
                                <input type="text" class="boxes" placeholder="&nbsp;&nbsp;簡短概述"  id="service">
                            </div>
                            <div class="grid-item">
                                <label for="motivation">加入動機</label>
                                <input type="text" class="boxes" placeholder="&nbsp;&nbsp;簡短概述" required id="motivation">
                            </div>
                            <div class="grid-item">
                                <label for="record">服務紀錄</label>
                                <input type="text" class="boxes" required id="record">
                            </div>
                        </div>
                    </div>
                    <div class="boxR">
                        <label for="exp">經驗</label>
                        <input type="text" id="exp" >
                    </div>
                </div>
                <div class="vReadyToSubmit">
                    <button class="closeMessageBox" type="submit" id="memberbtn">註冊</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Elder -->
    <div id="elderMsgBox" class="hidden">
        <div class="container">
            <div class="title">
                <h3>註冊</h3>
                <div class="knownAs">
                    <p>長者</p>
                </div>
                <div style="color:red; display:flex; align-items:center;">
                    <h4>*為必填欄位</h4>
                </div>
                <form method="get" action="/Main/Caseinfor">
                    <button class="closeMessageBox" id="closeElder" type="submit">&#x2716;</button>
                </form>            
            </div>
            <hr>
            <form class="elder">
                <div class="row">
                    <div class="col-3">
                        <label for="unitname">單位名稱<span class="required">*</span></label>
                        <input type="text" id="unitname" placeholder="&nbsp;&nbsp;" required>
                    </div>
                    <div class="col-3">
                        <label for="unitid">單位編號<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;" required id="unitid">
                    </div>
                    <div class="col-3">
                        <label for="id">個案編號<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;" value="@ViewBag.CaseNo"readonly required id="id">
                    </div>
                    <div class="col-3">
                        <label for="source">個案來源<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;" required id="source">
                    </div>
                </div>
                <div class="row">
                    <div class="col-3">
                        <label for="lastname">姓氏<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;" required id="lastname">
                    </div>
                    <div class="col-3">
                        <label for="firstname">名字<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;" required id="firstname">
                    </div>
                    <div class="col-3">
                        <label for="gender">性別<span class="required">*</span></label>
                        <select id="gender" required>
                            <option value=""></option>
                            <option value="男">男</option>
                            <option value="女">女</option>
                        </select>
                    </div>
                    <div class="col-3">
                        <label for="idcard">身分證<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;" required id="idcard">
                    </div>
                </div>
                <div class="row">
                    <div class="col-3">
                        <label  style="">出生日期<span class="required">*</span></label>
                        <select class="yearSelect" required id="year"></select>
                    </div>
                    <div class="col-3">
                        <label for="yearSelect" style=""><span class="required"></span></label>
                        <select class="monthselect" required id="month">
                            <option value="">月份</option>
                            <option value="1">一月</option>
                            <option value="2">二月</option>
                            <option value="3">三月</option>
                            <option value="4">四月</option>
                            <option value="5">五月</option>
                            <option value="6">六月</option>
                            <option value="7">七月</option>
                            <option value="8">八月</option>>
                            <option value="9">九月</option>
                            <option value="10">十月</option>
                            <option value="11">十一月</option>
                            <option value="12">十二月</option>

                        </select>
                    </div>
                    <div class="col-3">
                        <label for="yearSelect" style=""><span class="required"></span></label>
                        <select class="daySelect" required id="day"></select>
                    </div>
                    <div class="col-1">
                        <label for="language">語言</label>
                        <select id="language">
                            <option value=""></option>
                            <option value="國語">國語</option>
                            <option value="英語">英語</option>
                            <option value="台語">台語</option>
                            <option value="客語">客語</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                    <div class="col-2">
                        <label for="culture">信仰</label>
                        <select id="culture">
                            <option value=""></option>
                            <option value="道教">道教</option>
                            <option value="天主教">天主教</option>
                            <option value="基督教">基督教</option>
                            <option value="佛教">佛教</option>
                            <option value="伊斯蘭教">伊斯蘭教</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-4">
                        <label for="educationLevel">教育程度</label>
                        <select id="educationLevel" >
                            <option value=""></option>
                            <option value="不識字">不識字</option>
                            <option value="自修">自修</option>
                            <option value="國小">國小</option>
                            <option value="國中">國中</option>
                            <option value="高中職">高中職</option>
                            <option value="專科">專科</option>
                            <option value="大學">大學</option>
                            <option value="研究所以上">研究所以上</option>
                        </select>
                    </div>
                    <div class="col-4">
                        <label for="password">密碼<span class="required">*</span></label>
                        <input type="password" placeholder="&nbsp;&nbsp;" required id="password">
                    </div>
                    <div class="col-4">
                        <label for="passwordcheck">密碼確認<span class="required">*</span></label>
                        <input type="password" placeholder="&nbsp;&nbsp;" required id="passwordcheck">
                    </div>
                </div>
                <div class="row">
                    <div class="col-3">
                        <label for="marital-status">婚姻狀況</label>
                        <select id="marital-status">
                            <option value=""></option>
                            <option value="未婚">未婚</option>
                            <option value="已婚">已婚</option>
                            <option value="分居">分居</option>
                            <option value="喪偶">喪偶</option>
                        </select>
                    </div>
                    <div class="col-3">
                        <label for="family">聯絡人<span class="required">*</span></label>
                        <input type="text" placeholder="&nbsp;&nbsp;" id="family" required>
                    </div>
                    <div class="col-2">
                        <label for="relationship">聯絡人關係<span class="required">*</span></label>
                        <select id="relationship" required>
                            <option value=""></option>
                            <option value="父親">父親</option>
                            <option value="母親">母親</option>
                            <option value="夫妻">夫妻</option>
                            <option value="子女">子女</option>
                            <option value="兄弟">兄弟</option>
                            <option value="姐妹">姐妹</option>
                        </select>
                    </div>
                    <div class="col-4">
                        <label for="familyphone">聯絡人電話<span class="required">*</span></label>
                        <input type="tel" placeholder="&nbsp;&nbsp;" id="familyphone" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        <label for="address">長者居住地址<span class="required">*</span></label>
                        <input type="tel" placeholder="&nbsp;&nbsp;" id="address" required>
                    </div>
                    <div class="col-6">
                        <label for="familyaddress">聯絡人地址</label>
                        <input type="text" placeholder="&nbsp;&nbsp;"id="familyaddress">
                    </div>
                </div>
                <div class="row">
                    <div class="col-3">
                        <label for="family-status">家庭狀況</label>
                        <select id="family-status">
                            <option value=""></option>
                            <option value="核心家庭">核心家庭</option>
                            <option value="大家庭">大家庭</option>
                            <option value="單親家庭">單親家庭</option>
                            <option value="繼親">繼親</option>
                            <option value="隔代教養">隔代教養</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                    <div class="col-3">
                        <label for="listidentity">身份別<span class="required">*</span></label>
                        <select id="listidentity" required>
                            <option value=""></option>
                            <option value="低收入戶">低收入戶</option>
                            <option value="中低收入戶">中低收入戶</option>
                            <option value="一般戶老人">一般戶老人</option>
                            <option value="獨居老人">獨居老人</option>
                            <option value="身心障礙者">身心障礙者</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                    <div class="col-3">
                        <label for="listeconomy">經濟來源</label>
                        <select id="listeconomy">
                            <option value=""></option>
                            <option value="無">無</option>
                            <option value="子女奉養">子女奉養</option>
                            <option value="政府補助">政府補助</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                    <div class="col-3">
                        <label for="work">工作</label>
                        <input type="text" placeholder="&nbsp;&nbsp;"id="work">
                    </div>
                </div>
                <div class="row">
                    <div class="col-3">
                        <label for="health">身體狀況</label>
                        <select id="health">
                            <option value=""></option>
                            <option value="正常">正常</option>
                            <option value="輕微系統疾病但無功能障礙">輕微系統疾病但無功能障礙</option>
                            <option value="中等至嚴重程度的系統疾病且導致某些功能障礙">中等至嚴重程度的系統疾病且導致某些功能障礙</option>
                            <option value="嚴重程度的系統疾病且無法自理">嚴重程度的系統疾病且無法自理</option>
                        </select>
                    </div>
                    <div class="col-3">
                        <label for="factly">輔助器具</label>
                        <select id="factly">
                            <option value=""></option>
                            <option value="無">無 </option>
                            <option value="助聽器 ">助聽器 </option>
                            <option value="輪椅">輪椅</option>
                            <option value="助行器">助行器</option>
                            <option value="柺杖">柺杖</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                    <div class="col-3">
                        <label for="activity-type">活動型態</label>
                        <select id="activity-type">
                            <option value=""></option>
                            <option value="完全自理">完全自理</option>
                            <option value="部分自理">部分自理</option>
                            <option value="完全無法自理">完全無法自理</option>
                        </select>
                    </div>
                    <div class="col-3">
                        <label for="house-condition">屋況</label>
                        <select id="house-condition">
                            <option value=""></option>
                            <option value="自有住宅">自有住宅</option>
                            <option value="租賃">租賃</option>
                            <option value="借住">借住</option>
                            <option value="臨時住屋">臨時住屋</option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-4">
                        <label for="interest">興趣與專長</label>
                        <input type="text" class="elderBoxes" placeholder="&nbsp;&nbsp;簡短概述三項"id="interest">
                    </div>
                    <div class="col-4">
                        <label for="question">主觀問題</label>
                        <input type="text" class="elderBoxes" placeholder="&nbsp;&nbsp;簡短概述" id="question">
                    </div>
                    <div class="col-4">
                        <label for="replenish">補充陳述</label>
                        <input type="text" class="elderBoxes" placeholder="&nbsp;&nbsp;簡短概述"id="replenish">
                    </div>
                </div>
                <div class="eReadyToSubmit">
                    <button class="closeMessageBox" id="sendbtn">註冊</button>
                </div>
            </form>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        const memidcard = document.getElementById('memidcard');

        function validateIDCard(event) {
            
        }

        memberbtn.addEventListener('submit', validateIDCard);

    </script>
    <script>
        //--------------長者註冊----------------
        var sendbtn = document.getElementById("sendbtn")
        sendbtn.addEventListener("click", function (event) {
            event.preventDefault();
            var unitname = document.getElementById("unitname").value;
            var unitid = document.getElementById("unitid").value;
            var id = document.getElementById("id").value;
            var source = document.getElementById("source").value;
            var lastname = document.getElementById("lastname").value;
            var firstname = document.getElementById("firstname").value;
            var gender = document.getElementById("gender").value;
            var educationLevel = document.getElementById("educationLevel").value;
            var year = document.getElementById("year").value;
            var month = document.getElementById("month").value;
            var day = document.getElementById("day").value;
            var language = document.getElementById("language").value;
            var culture = document.getElementById("culture").value;
            var idcard = document.getElementById("idcard").value;
            var password = document.getElementById("password").value;
            var passwordcheck = document.getElementById("passwordcheck").value;
            var marital_status = document.getElementById("marital-status").value;
            var family = document.getElementById("family").value;
            var relationship = document.getElementById("relationship").value;
            var familyphone = document.getElementById("familyphone").value;
            var address = document.getElementById("address").value;
            var familyaddress = document.getElementById("familyaddress").value;
            var family_status = document.getElementById("family-status").value;
            var listidentity = document.getElementById("listidentity").value;
            var listeconomy = document.getElementById("listeconomy").value;
            var work = document.getElementById("work").value;
            var health = document.getElementById("health").value;
            var activity_type = document.getElementById("activity-type").value;
            var house_condition = document.getElementById("house-condition").value;
            var interest = document.getElementById("interest").value;
            var question = document.getElementById("question").value;
            var replenish = document.getElementById("replenish").value;
            var factly = document.getElementById("factly").value;
            var Name = lastname + firstname;
            var RegTime = new Date();
            var bd = year + "/" + month + "/" + day;

            
                
                var idCardRegex = /^[A-Z]\d{9}$/;
                if (unitname === "" || unitid === "" || id === "" || lastname === "" || firstname === "" || gender === "" || year === "" || month === "" || day === "" || idcard === "" || password === "" || passwordcheck === "") {
                    // 有必填欄位為空，彈出警示框提示使用者
                    alert("請填寫必填欄位");
                    return; // 停止後續操作
                }
                if (!idCardRegex.test(idcard)) {
                    alert("身分證格式不正確");
                    return; // Stop further execution
                }

                // Validate password match
                if (password !== passwordcheck) {
                    alert("密碼與確認密碼不一致");
                    return; // Stop further execution
                }
                var xhr = new XMLHttpRequest();
                xhr.open("POST", "/Main/Caseinfor", true);
                xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");

                // 將selectedValue轉換為JSON格式
                var data = {
                    "type": 2,
                    "CaseNo": id,
                    "CaseUnitName": unitname,
                    "CaseUnitNum": unitid,
                    "CaseName": Name,
                    "CaseIdcard": idcard,
                    "CasePassword": password,
                    "CaseGender": gender,
                    "CaseRelig": culture,
                    "CaseBd": bd,
                    "CaseLang": language,
                    "CaseSource": source,
                    "CaseWork": work,
                    "CaseProf": interest,
                    "CaseEdu": educationLevel,
                    "CaseAddr": address,
                    "CaseHouse": house_condition,
                    "CaseIdent": listidentity,
                    "CaseFund": listeconomy,
                    "CaseHealth": health,
                    "CaseActv": activity_type,
                    "CaseFactly": factly,
                    "CaseMari": marital_status,
                    "CaseCnta": family,
                    "CaseCntTel": familyphone,
                    "CaseCntRel": relationship,
                    "CaseCntAdd": familyaddress,
                    "CaseFami": family_status,
                    "CaseQues": question,
                    "CaseDesc": replenish,
                    "CaseRegName": Name,
                    "CaseRegTime": RegTime,
                }

                xhr.onreadystatechange = function () {
                    if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
                        // 請求成功，執行相應的處理邏輯
                        alert("註冊成功");
                        window.location.href = "/Main/Login";
                        var response = JSON.parse(xhr.responseText);
                        
                       
                    }

                };
                xhr.send(JSON.stringify(data));
            


        })
    </script>
    <script>
        var memberbtn = document.getElementById("memberbtn")
        memberbtn.addEventListener("click", function (event) {
            event.preventDefault();
            var unitname = document.getElementById("memunitname").value;
            var unitid = document.getElementById("memunitid").value;
            var id = document.getElementById("memid").value;
            var lastname = document.getElementById("memlastname").value;
            var firstname = document.getElementById("memfirstname").value;
            var gender = document.getElementById("memgender").value;
            var educationLevel = document.getElementById("memeducationLevel").value;
            var year = document.getElementById("memyear").value;
            var month = document.getElementById("memmonth").value;
            var day = document.getElementById("memday").value;
            var idcard = document.getElementById("memidcard").value;
            var password = document.getElementById("mempassword").value;
            var passwordcheck = document.getElementById("mempasswordcheck").value;
            var address = document.getElementById("memaddress").value;
            var tel = document.getElementById("memtel").value;
            var phone = document.getElementById("memphone").value;
            var listidentity = document.getElementById("memlistidentity").value;
            var expertise = document.getElementById("expertise").value;
            var serviceaddress = document.getElementById("serviceaddress").value;
            var transportation = document.getElementById("transportation").value;
            var license = document.getElementById("license").value;
            var service = document.getElementById("service").value;
            var motivation = document.getElementById("motivation").value;
            var record = document.getElementById("record").value;
            var exp = document.getElementById("exp").value;
            var icnum = document.getElementById("memicnum").value;

            var Name = lastname + firstname;
            var bd = year + "/" + month + "/" + day;
            var idCardRegex = /^[A-Z]\d{9}$/;
            if (unitname === "" || unitid === "" || id === "" || lastname === "" || firstname === "" || gender === "" || year === "" || month === "" || day === "" || idcard === "" || password === "" || passwordcheck === "") {
                // 有必填欄位為空，彈出警示框提示使用者
                alert("請填寫必填欄位");
                return; // 停止後續操作
            }
            if (!idCardRegex.test(idcard)) {
                alert("身分證格式不正確");
                return; // Stop further execution
            }

            // Validate password match
            if (password !== passwordcheck) {
                alert("密碼與確認密碼不一致");
                return; // Stop further execution
            }
           
                

                var xhr = new XMLHttpRequest();
                xhr.open("POST", "/Main/Caseinfor", true);
                xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");

                // 將selectedValue轉換為JSON格式
                var data = {
                    "type": 1,
                    "MemSid": id,
                    "MemUnitName": unitname,
                    "MemUnitNum": unitid,
                    "MemName": Name,
                    "MemUid": idcard,
                    "MemPassword": password,
                    "MemGender": gender,
                    "MemBd": bd,
                    "MemTphone": tel,
                    "MemMphone": phone,
                    "MemAddress": address,
                    "MemSite": serviceaddress,
                    "MemProf": expertise,
                    "MemCert": license,
                    "MemTrans": transportation,
                    "MemExpr": exp,
                    "MemMovt": motivation,
                    "MemPserv": service,
                    "MemIdent": listidentity,
                    "MemSerRec": record,
                    "MemEdu": educationLevel,
                    "MemIcnum": icnum
                }

                xhr.onreadystatechange = function () {
                    if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
                        // 請求成功，執行相應的處理邏輯
                        alert("註冊成功");
                        window.location.href = "/Main/Login";
                        var response = JSON.parse(xhr.responseText);
                        
                    }

                };
                xhr.send(JSON.stringify(data));
        })
    </script>
</body>
